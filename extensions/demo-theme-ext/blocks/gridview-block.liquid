<div id="gridview-widget-{{ section.id }}" class="gridview-container" data-app-id="{{ app.id }}" data-shop="{{ shop.permanent_domain }}">
  <!-- Content will be loaded dynamically from app -->
</div>

<script>
(function() {
  const container = document.getElementById('gridview-widget-{{ section.id }}');
  if (!container) return;
  
  const appId = container.dataset.appId;
  const shop = container.dataset.shop;
  
  // Load widget from app
  const script = document.createElement('script');
  script.src = `{{ shop.url }}/apps/easyd-2/widgets/gridview.js?shop=${shop}&app=${appId}&section={{ section.id }}`;
  script.async = true;
  script.onload = () => {
    console.log('üéâ GridView widget script loaded successfully');
  };
  script.onerror = (error) => {
    console.error('‚ùå Failed to load GridView widget script:', error);
    console.error('‚ùå Script URL:', script.src);
    // Fallback: try to load from different URL
    const fallbackScript = document.createElement('script');
    fallbackScript.src = `https://buys-exciting-husband-dans.trycloudflare.com/widgets/gridview.js?shop=${shop}&app=${appId}&section={{ section.id }}`;
    fallbackScript.async = true;
    fallbackScript.onload = () => {
      console.log('üéâ GridView widget script loaded from fallback URL');
    };
    fallbackScript.onerror = () => {
      console.error('‚ùå Fallback script also failed to load');
    };
    document.head.appendChild(fallbackScript);
  };
  document.head.appendChild(script);
})();
</script>

{% schema %}
{
  "name": "Grid View Block",
  "target": "section",
  "settings": [
    {
      "type": "product",
      "id": "product",
      "label": "Select Product"
    }
  ]
}
{% endschema %}