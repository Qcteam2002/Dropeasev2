{% comment %} --- Policy Features Block --- {% endcomment %}
<div class="policy-features-section" style="max-width: 1200px; margin: 0 auto; padding: 20px 0;">
  {% assign policy_config = shop.metafields.custom.policy_features_config.value | parse_json %}

  {% assign should_display = false %}
  {% if request.design_mode %}
    {% assign should_display = true %}
    {% unless policy_config %}
      {% assign policy_config = '{"isActive":true,"iconSize":24,"spacing":20,"backgroundColor":"#ffffff","iconColor":"#000000","selectedFeatures":["free_shipping","money_back","secure_payment","easy_returns"]}' | parse_json %}
    {% endunless %}
  {% elsif policy_config.isActive %}
    {% assign should_display = true %}
  {% endif %}

  <script>
    console.log('Policy Features Debug:', {
      hasMetafield: {% if policy_config != blank %}true{% else %}false{% endif %},
      isActive: {% if policy_config %}{{ policy_config.isActive | json }}{% else %}false{% endif %},
      isDesignMode: {{ request.design_mode | json }},
      shouldDisplay: {{ should_display | json }},
      config: {% if policy_config %}{{ policy_config | json }}{% else %}null{% endif %}
    });
  </script>

  {% if should_display %}
    <div class="policy-features" style="display: flex; flex-direction: column; gap: 0;">
      {% if block.settings.show_free_shipping %}
        <div class="policy-feature-item" style="display: flex; padding: 12px 0; flex-direction: row; border-top: 1px solid {{ block.settings.color | default: '#000000' }}; align-items: center;">
          <div class="icon-wrapper" style="margin-right: 7px; width: 24px; height: 24px; color: {{ block.settings.color | default: '#000000' }}; opacity: 0.8;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M4 5.25a.75.75 0 0 1 .75-.75h6.991a2.75 2.75 0 0 1 2.645 1.995l.427 1.494a.25.25 0 0 0 .18.173l1.681.421a1.75 1.75 0 0 1 1.326 1.698v1.219a1.75 1.75 0 0 1-1.032 1.597 2.5 2.5 0 1 1-4.955.153h-3.025a2.5 2.5 0 1 1-4.78-.75h-.458a.75.75 0 0 1 0-1.5h2.5c.03 0 .06.002.088.005a2.493 2.493 0 0 1 1.947.745h4.43a2.493 2.493 0 0 1 1.785-.75c.698 0 1.33.286 1.783.748a.25.25 0 0 0 .217-.248v-1.22a.25.25 0 0 0-.19-.242l-1.682-.42a1.75 1.75 0 0 1-1.258-1.217l-.427-1.494a1.25 1.25 0 0 0-1.202-.907h-6.991a.75.75 0 0 1-.75-.75Zm2.5 9.25a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm8 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"/>
              <path d="M3.25 8a.75.75 0 0 0 0 1.5h5a.75.75 0 0 0 0-1.5h-5Z"/>
            </svg>
          </div>
          <span class="feature-text">Free Shipping</span>
        </div>
      {% endif %}

      {% if block.settings.show_money_back %}
        <div class="policy-feature-item" style="display: flex; padding: 12px 0; flex-direction: row; border-top: 1px solid {{ block.settings.color | default: '#000000' }}; align-items: center;">
          <div class="icon-wrapper" style="margin-right: 7px; width: 24px; height: 24px; color: {{ block.settings.color | default: '#000000' }}; opacity: 0.8;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M15 10.75v-2.75h-10v6.75c0 .138.112.25.25.25h4c.414 0 .75.336.75.75s-.336.75-.75.75h-4c-.966 0-1.75-.784-1.75-1.75v-6.863c0-.57.177-1.125.506-1.59l1.309-1.848c.421-.595 1.106-.949 1.836-.949h5.796c.753 0 1.455.376 1.872 1.002l1.22 1.828c.3.452.461.983.461 1.526v2.894c0 .414-.336.75-.75.75s-.75-.336-.75-.75Zm-8.461-5.434c.14-.198.368-.316.612-.316h2.099v1.5h-3.55l.839-1.184Zm7.81 1.184h-3.599v-1.5h2.197c.251 0 .485.125.624.334l.778 1.166Z"/>
              <path fill-rule="evenodd" d="M6 10c0-.552.448-1 1-1h4c.552 0 1 .448 1 1v3c0 .552-.448 1-1 1h-4c-.552 0-1-.448-1-1v-3Zm1.5.5v2h3v-2h-3Z"/>
              <path d="M17.5 12.75c0-.414-.336-.75-.75-.75s-.75.336-.75.75v.5c0 .966-.784 1.75-1.75 1.75h-.94l.22-.22c.293-.293.293-.767 0-1.06-.293-.293-.767-.293-1.06 0l-1.5 1.5c-.293.293-.293.767 0 1.06l1.5 1.5c.293.293.767.293 1.06 0 .293-.293.293-.767 0-1.06l-.22-.22h.94c1.795 0 3.25-1.455 3.25-3.25v-.5Z"/>
            </svg>
          </div>
          <span class="feature-text">Money Back Guarantee</span>
        </div>
      {% endif %}

      {% if block.settings.show_secure_payment %}
        <div class="policy-feature-item" style="display: flex; padding: 12px 0; flex-direction: row; border-top: 1px solid {{ block.settings.color | default: '#000000' }}; align-items: center;">
          <div class="icon-wrapper" style="margin-right: 7px; width: 24px; height: 24px; color: {{ block.settings.color | default: '#000000' }}; opacity: 0.8;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path d="M8.28 8.683a.75.75 0 0 0-1.06 1.06l1.548 1.548a.75.75 0 0 0 1.06 0l2.963-2.962a.75.75 0 0 0-1.06-1.06l-2.433 2.431-1.018-1.017Z"/>
              <path fill-rule="evenodd" d="M11.093 2.914a1.75 1.75 0 0 0-2.186 0l-.317.253a15.25 15.25 0 0 1-3.217 1.976l-.847.384a1.71 1.71 0 0 0-1.01 1.628c.28 6.25 4.38 9.048 5.732 9.802.47.262 1.034.262 1.503 0 1.352-.753 5.454-3.55 5.734-9.783a1.71 1.71 0 0 0-1.002-1.623l-.9-.416a15.249 15.249 0 0 1-3.136-1.938l-.354-.283Zm-1.25 1.171a.25.25 0 0 1 .313 0l.354.283a16.749 16.749 0 0 0 3.445 2.129l.9.415a.213.213 0 0 1 .131.195c-.246 5.489-3.827 7.906-4.965 8.54a.042.042 0 0 1-.02.006c-.005 0-.012 0-.022-.006-1.136-.634-4.718-3.053-4.965-8.56-.003-.066.037-.15.133-.194l.846-.385a16.75 16.75 0 0 0 3.534-2.17l.317-.253Z"/>
            </svg>
          </div>
          <span class="feature-text">Secure Payment</span>
        </div>
      {% endif %}

      {% if block.settings.show_return %}
        <div class="policy-feature-item" style="display: flex; padding: 12px 0; flex-direction: row; border-top: 1px solid {{ block.settings.color | default: '#000000' }}; align-items: center;">
          <div class="icon-wrapper" style="margin-right: 7px; width: 24px; height: 24px; color: {{ block.settings.color | default: '#000000' }}; opacity: 0.8;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M12.379 4h-7.258c-.395 0-.736 0-1.017.023-.297.024-.592.078-.875.222-.424.216-.768.56-.984.984-.144.283-.198.578-.222.875-.023.28-.023.622-.023 1.017v3.008c0 .395 0 .736.023 1.017.024.297.078.592.222.875.216.424.56.768.984.984.283.144.578.198.875.222.121.01.254.016.397.019.001.243.006.46.022.65.024.297.078.592.222.875.216.424.56.768.984.984.283.144.578.198.875.222.28.023.622.023 1.017.023h7.258c.395 0 .736 0 1.017-.023.297-.024.592-.078.875-.222.424-.216.768-.56.984-.984.144-.283.198-.578.222-.875.023-.28.023-.622.023-1.017v-3.008c0-.395 0-.736-.023-1.017-.024-.297-.078-.592-.222-.875-.216-.424-.56-.768-.983-.984-.284-.144-.58-.198-.876-.222-.121-.01-.254-.016-.397-.019-.001-.243-.006-.46-.022-.65-.024-.297-.078-.592-.222-.875-.216-.424-.56-.768-.984-.984-.283-.144-.578-.198-.875-.222-.28-.023-.622-.023-1.017-.023Zm1.62 2.75h-6.378c-.395 0-.736 0-1.017.023-.297.024-.592.078-.875.222-.424.216-.768.56-.984.984-.144.283-.198.578-.222.875-.023.28-.023.622-.023 1.017v1.874c-.104-.002-.194-.006-.274-.013-.204-.017-.28-.045-.316-.064-.142-.072-.256-.186-.328-.327-.02-.038-.047-.113-.064-.317-.017-.212-.018-.492-.018-.924v-2.95c0-.432 0-.712.018-.924.017-.204.045-.28.064-.316.072-.142.186-.256.328-.328.037-.02.112-.047.316-.064.212-.017.492-.018.924-.018h7.2c.432 0 .712 0 .924.018.204.017.28.045.317.064.14.072.255.186.327.328.02.037.047.112.064.316.011.138.016.305.017.524Zm-6.349 7.75h1.178c-.515-.796-.828-1.848-.828-3 0-1.278.385-2.43 1.002-3.25h-1.352c-.432 0-.712 0-.924.018-.204.017-.28.045-.316.064-.142.072-.256.186-.328.328-.02.037-.047.112-.064.316-.017.212-.018.492-.018.924v2.95c0 .432 0 .712.018.924.017.204.045.28.064.317.072.14.186.255.328.327.037.02.112.047.316.064.212.017.492.018.924.018Zm6.85-3c0-1.278-.384-2.43-1.002-3.25h1.352c.432 0 .712 0 .924.018.204.017.28.045.316.064.142.072.256.186.328.328.02.037.047.112.064.316.017.212.018.492.018.924v2.95c0 .432 0 .712-.018.924-.017.204-.045.28-.064.317-.072.14-.186.255-.328.327-.037.02-.112.047-.316.064-.212.017-.492.018-.924.018h-1.178c.515-.796.828-1.848.828-3Zm-4.332 2.304c-.384-.532-.668-1.342-.668-2.304 0-.962.284-1.772.668-2.304.385-.533.787-.696 1.082-.696.295 0 .697.163 1.082.696.384.532.668 1.342.668 2.304 0 .962-.284 1.772-.668 2.304-.385.533-.787.696-1.082.696-.295 0-.697-.163-1.082-.696Z"/>
            </svg>
          </div>
          <span class="feature-text">Easy Returns</span>
        </div>
      {% endif %}

      {% if block.settings.show_express_shipping %}
        <div class="policy-feature-item" style="display: flex; padding: 12px 0; flex-direction: row; border-top: 1px solid {{ block.settings.color | default: '#000000' }}; align-items: center;">
          <div class="icon-wrapper" style="margin-right: 7px; width: 24px; height: 24px; color: {{ block.settings.color | default: '#000000' }}; opacity: 0.8;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M4 5.25a.75.75 0 0 1 .75-.75h6.991a2.75 2.75 0 0 1 2.645 1.995l.427 1.494a.25.25 0 0 0 .18.173l1.681.421a1.75 1.75 0 0 1 1.326 1.698v1.219a1.75 1.75 0 0 1-1.032 1.597 2.5 2.5 0 1 1-4.955.153h-3.025a2.5 2.5 0 1 1-4.78-.75h-.458a.75.75 0 0 1 0-1.5h2.5c.03 0 .06.002.088.005a2.493 2.493 0 0 1 1.947.745h4.43a2.493 2.493 0 0 1 1.785-.75c.698 0 1.33.286 1.783.748a.25.25 0 0 0 .217-.248v-1.22a.25.25 0 0 0-.19-.242l-1.682-.42a1.75 1.75 0 0 1-1.258-1.217l-.427-1.494a1.25 1.25 0 0 0-1.202-.907h-6.991a.75.75 0 0 1-.75-.75Zm2.5 9.25a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm8 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"/>
              <path d="M3.25 8a.75.75 0 0 0 0 1.5h5a.75.75 0 0 0 0-1.5h-5Z"/>
            </svg>
          </div>
          <span class="feature-text">Complimentary Shipping & Returns</span>
        </div>
      {% endif %}
    </div>
  {% endif %}

  <style>
    .policy-features {
      width: 100%;
      padding: 15px;
      background: {{ block.settings.background | default: '#ffffff' }};
      border-radius: 8px;
    }
    .policy-feature-item {
      color: {{ block.settings.color | default: '#000000' }};
    }
    .icon-wrapper svg {
      width: 100%;
      height: 100%;
      fill: currentColor;
    }
    .feature-text {
      font-family: 'Santral W01', sans-serif;
      font-size: 13px;
      color: {{ block.settings.color | default: '#000000' }};
      line-height: 1.2;
      letter-spacing: 0.5px;
    }
    @media screen and (max-width: 749px) {
      .policy-features {
        flex-direction: column;
        align-items: flex-start;
      }
      .policy-feature-item {
        width: 100%;
      }
    }
  </style>

  {% schema %}
  {
    "name": "Policy Features",
    "target": "section",
    "settings": [
      {
        "type": "header",
        "content": "Policy Features Settings"
      },
      {
        "type": "checkbox",
        "id": "show_free_shipping",
        "label": "Show Free Shipping",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "show_money_back",
        "label": "Show Money Back",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "show_secure_payment",
        "label": "Show Secure Payment",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "show_return",
        "label": "Show Easy Returns",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "show_express_shipping",
        "label": "Show Express Shipping",
        "default": true
      },
      {
        "type": "header",
        "content": "Style Settings"
      },
      {
        "type": "color",
        "id": "color",
        "label": "Text & Icon Color",
        "default": "#000000"
      },
      {
        "type": "color_background",
        "id": "background",
        "label": "Background Color",
        "default": "#ffffff"
      }
    ]
  }
  {% endschema %}
</div>